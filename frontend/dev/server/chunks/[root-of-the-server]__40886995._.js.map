{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/prashanthgundala/Desktop/finance-dashboard/src/lib/plaid.ts"],"sourcesContent":["import { Configuration, PlaidApi, PlaidEnvironments } from \"plaid\";\n\nconst configuration = new Configuration({\n    basePath: PlaidEnvironments.sandbox,\n    baseOptions: {\n        headers: {\n            'PLAID-CLIENT-ID': process.env.PLAID_CLIENT_ID,\n            'PLAID-SECRET': process.env.PLAID_SECRET,\n        },\n    },\n});\n\nexport const plaidClient = new PlaidApi(configuration);"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,gBAAgB,IAAI,yJAAa,CAAC;IACpC,UAAU,6JAAiB,CAAC,OAAO;IACnC,aAAa;QACT,SAAS;YACL,mBAAmB,QAAQ,GAAG,CAAC,eAAe;YAC9C,gBAAgB,QAAQ,GAAG,CAAC,YAAY;QAC5C;IACJ;AACJ;AAEO,MAAM,cAAc,IAAI,oJAAQ,CAAC"}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":["file:///Users/prashanthgundala/Desktop/finance-dashboard/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined;\n};\n\nexport const db = globalForPrisma.prisma ?? new PrismaClient();\n\nif(process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = db;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,KAAK,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAE5D,wCAA0C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///Users/prashanthgundala/Desktop/finance-dashboard/src/app/api/plaid/exchange-token/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { plaidClient } from \"@/lib/plaid\";\nimport { db } from \"@/lib/db\";\nimport { auth, currentUser } from \"@clerk/nextjs/server\";\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const { public_token } = body;\n\n        const response = await plaidClient.itemPublicTokenExchange({\n            public_token\n        });\n\n        const accessToken = response.data.access_token;\n        const itemId = response.data.item_id;\n\n        const { userId } = await auth();\n        const user = await currentUser();\n\n        if(!userId || !user) {\n            return NextResponse.json({ error: \"Unauthorized\" }, {status: 401});\n        }\n\n        await db.user.upsert({\n            where: { id: userId },\n            update: {},\n            create: {\n                id: userId,\n                email: user.emailAddresses[0]?.emailAddress || \"no-email@example.com\",\n                clerkUserId: userId,\n                firstName: user.firstName,\n                lastName: user.lastName\n            }\n        });\n\n        await db.account.create({\n            data: {\n                userId: userId,\n                plaidAccountId: itemId,\n                plaidAccessToken: accessToken,\n                name: \"Plaid Connected Bank\",\n                type: \"depository\",\n                currentBalance: 0\n            }\n        });\n\n        console.log(\"Success! The Access Token saved to the database.\");\n\n        return NextResponse.json({ success: true});\n    } catch(error) {\n        console.error(\"Exchange Error:\", error);\n        return NextResponse.json({error: \"Failed to exchange token\"}, {status: 500});\n    }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,YAAY,EAAE,GAAG;QAEzB,MAAM,WAAW,MAAM,oIAAW,CAAC,uBAAuB,CAAC;YACvD;QACJ;QAEA,MAAM,cAAc,SAAS,IAAI,CAAC,YAAY;QAC9C,MAAM,SAAS,SAAS,IAAI,CAAC,OAAO;QAEpC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,6LAAI;QAC7B,MAAM,OAAO,MAAM,IAAA,2MAAW;QAE9B,IAAG,CAAC,UAAU,CAAC,MAAM;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAC,QAAQ;YAAG;QACpE;QAEA,MAAM,wHAAE,CAAC,IAAI,CAAC,MAAM,CAAC;YACjB,OAAO;gBAAE,IAAI;YAAO;YACpB,QAAQ,CAAC;YACT,QAAQ;gBACJ,IAAI;gBACJ,OAAO,KAAK,cAAc,CAAC,EAAE,EAAE,gBAAgB;gBAC/C,aAAa;gBACb,WAAW,KAAK,SAAS;gBACzB,UAAU,KAAK,QAAQ;YAC3B;QACJ;QAEA,MAAM,wHAAE,CAAC,OAAO,CAAC,MAAM,CAAC;YACpB,MAAM;gBACF,QAAQ;gBACR,gBAAgB;gBAChB,kBAAkB;gBAClB,MAAM;gBACN,MAAM;gBACN,gBAAgB;YACpB;QACJ;QAEA,QAAQ,GAAG,CAAC;QAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAI;IAC5C,EAAE,OAAM,OAAO;QACX,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAC,OAAO;QAA0B,GAAG;YAAC,QAAQ;QAAG;IAC9E;AACJ"}}]
}