{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/prashanthgundala/Desktop/finance-dashboard/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined;\n};\n\nexport const db = globalForPrisma.prisma ?? new PrismaClient();\n\nif(process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = db;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,KAAK,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAE5D,wCAA0C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///Users/prashanthgundala/Desktop/finance-dashboard/src/app/api/insights/route.ts"],"sourcesContent":["import { NextResponse } from  \"next/server\";\nimport { db } from  \"@/lib/db\";\nimport { auth } from \"@clerk/nextjs/server\";\nimport OpenAI from \"openai\";\n\nconst openai = new OpenAI({\n    apiKey: process.env.OPENAI_API_KEY,\n});\n\nexport async function POST() {\n    try {\n        const { userId } = await auth();\n        if(!userId) {\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n        }\n\n        const transactions = await db.transaction.findMany({\n            where: { userId },\n            orderBy: { date: \"desc\" },\n            take: 30,\n        });\n\n        if(transactions.length === 0) {\n            return NextResponse.json({ \n                insight: {\n                    summary: \"No transactions found to analyze.\",\n                    savings: \"Start spending to see insights!\",\n                    positive: \"You have no debt!\"\n                }\n            });\n        }\n\n        const transactionSummary = transactions.map(t => \n            `${t.name}: $${t.amount} (${t.date.toISOString().split('T')[0]})`\n        ).join(\"\\n\");\n\n        const prompt = `\n            You are a friendly financial advisor. \n            Analyze the following recent financial transactions:\n            ${transactionSummary}\n\n            Return a JSON object with exactly three keys:\n            1. \"summary\": A brief summary of spending habits (max 2 sentences).\n            2. \"savings\": One specific area to save money (max 2 sentences).\n            3. \"positive\": A positive reinforcement or compliment (max 2 sentences).\n            \n            Do not use markdown. Just plain text strings for the values.\n        `;\n\n        const completion = await openai.chat.completions.create({\n            messages: [{ role: \"user\", content: prompt}],\n            model: \"gpt-5-mini\",\n            response_format: {type: \"json_object\" },\n        });\n\n        // const insight = completion.choices[0].message.content;\n        const insightContent = completion.choices[0].message.content;\n        const insightData = insightContent ? JSON.parse(insightContent) : null;\n\n        return NextResponse.json({ insight: insightData });\n\n        // return NextResponse.json({ insight });\n    } catch(error) {\n        console.error(\"AI Error:\", error);\n        return NextResponse.json({ error: \"Failed to generate insights\" }, { status: 500 });\n    }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;;;;;AAEA,MAAM,SAAS,IAAI,mLAAM,CAAC;IACtB,QAAQ,QAAQ,GAAG,CAAC,cAAc;AACtC;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,6LAAI;QAC7B,IAAG,CAAC,QAAQ;YACR,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,eAAe,MAAM,wHAAE,CAAC,WAAW,CAAC,QAAQ,CAAC;YAC/C,OAAO;gBAAE;YAAO;YAChB,SAAS;gBAAE,MAAM;YAAO;YACxB,MAAM;QACV;QAEA,IAAG,aAAa,MAAM,KAAK,GAAG;YAC1B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACrB,SAAS;oBACL,SAAS;oBACT,SAAS;oBACT,UAAU;gBACd;YACJ;QACJ;QAEA,MAAM,qBAAqB,aAAa,GAAG,CAAC,CAAA,IACxC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EACnE,IAAI,CAAC;QAEP,MAAM,SAAS,CAAC;;;YAGZ,EAAE,mBAAmB;;;;;;;;QAQzB,CAAC;QAED,MAAM,aAAa,MAAM,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACpD,UAAU;gBAAC;oBAAE,MAAM;oBAAQ,SAAS;gBAAM;aAAE;YAC5C,OAAO;YACP,iBAAiB;gBAAC,MAAM;YAAc;QAC1C;QAEA,yDAAyD;QACzD,MAAM,iBAAiB,WAAW,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO;QAC5D,MAAM,cAAc,iBAAiB,KAAK,KAAK,CAAC,kBAAkB;QAElE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAY;IAEhD,yCAAyC;IAC7C,EAAE,OAAM,OAAO;QACX,QAAQ,KAAK,CAAC,aAAa;QAC3B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA8B,GAAG;YAAE,QAAQ;QAAI;IACrF;AACJ"}}]
}